const mapID="worldMap";var locations,locationID,selectedZoom=6.5,beforezoom=selectedZoom,focusX=-1183,focusY=-166,pinX=4898,pinY=3143,targets=[],onMenu=!1;readTextFile("./public/json/locations.json",(function(e){locations=JSON.parse(e)}));for(let e=0;e<9;e++)readTextFile(`./public/json/targets_${e}.json`,(function(t){if(targets[e]=JSON.parse(t),optionsComp="<option selected>Hedef Konum Se√ßiniz</option>",0==e){targets[0].forEach((e=>{optionsComp+=`<option value="${parseInt(e.id)}">${e.room_code} ${e.name.trim()}</option>`})),document.getElementById("floatingSelect").innerHTML=optionsComp}}));function zoomInOnMap(){beforezoom=selectedZoom,getEastMapZoom(selectedZoom+=.5)}function zoomOutOnMap(){beforezoom=selectedZoom,getEastMapZoom(selectedZoom-=.5)}function onCurrLocation(){getCoords(focusX,focusY)}function openMenuButton(){onMenu=!0,openMenu()}function closeMenuButton(){onMenu=!1,closeMenu()}function clickItsMap(){onMenu=!1,closeMenu()}readTextFile("./public/json/locations.json",(function(e){locations=JSON.parse(e)})),window.onload=function(){getStart()},window.onresize=function(){0==onMenu&&location.reload()},document.getElementsByClassName("zoom-in")[0].addEventListener("click",zoomInOnMap),document.getElementsByClassName("zoom-out")[0].addEventListener("click",zoomOutOnMap),document.getElementsByClassName("on-location-btn")[0].addEventListener("click",onCurrLocation),document.getElementsByClassName("open-menu-button")[0].addEventListener("click",openMenuButton),document.getElementsByClassName("close-menu-button")[0].addEventListener("click",closeMenuButton),document.getElementsByClassName("map-image")[0].addEventListener("click",clickItsMap),$(document).on("change","#floatingSelect",(function(){let e=$(this).val(),t=targets[locationID][e],o=t.paths,n="",a="";o.forEach((e=>{a+=", "+e.directive;let t=`<div class="col-12">\n            <div class="row">\n                <div class="col-2">\n                    <h1 class="route-icon"><i class="${e.icon}"></i></h1>\n                </div>\n                <div class="col-10">\n                    <h4 class="route-head">${e.directive}</h4>\n                    <p class="route-desc">${e.description}</p>\n                </div>\n            </div>\n        </div>`;n+=t})),document.getElementsByClassName("menu-route")[0].innerHTML=n,$("#location-image").find("img").attr("src",`public/img/route/${t.route_image}`),speakText(a)}));let satalliteShow=!1;async function getStart(){let e=await setInterval((()=>{if(null!=locations){let t;clearInterval(e);let o=getGETParam("location");null!=o?locations.forEach((e=>{o==e.code&&(t=e.id)})):t=0,locationID=t,pinX=locations[t].pinX,pinY=locations[t].pinY,focusX=locations[t].focusX,focusY=locations[t].focusY,selectedZoom=locations[t].zoom,getPinLocate(pinX,pinY),genMap(),getEastMapZoom(selectedZoom),setTimeout((()=>{document.getElementsByClassName("zoom-in")[0].click(),setTimeout((()=>{getCoords(focusX,focusY),setTimeout((()=>{let e=document.querySelectorAll(".wait-loading");for(var t=0;t<e.length;t++)e[t].classList.remove("wait-loading");document.getElementsByClassName("loading")[0].classList.add("hide")}),40)}),40)}),40)}}),40);$(".select2").select2()}function getPinLocate(e,t){let o=document.getElementById("pin");o.style.top=e,o.style.left=t;let n=o.children[0];for(const o of n.attributes)"main-left"==o.name&&(o.value=e),"main-top"==o.name&&(o.value=t)}function genMap(){new SpryMap({id:mapID,width:window.innerWidth,height:window.innerHeight,cssClass:"mappy"});let e=document.getElementsByClassName("map-item");for(const t of e)t.style.position="absolute"}function getCoords(e=0,t=0){let o=document.getElementById(mapID);xpx=e+"px",ypx=t+"px",o.style.top=ypx,o.style.left=xpx}function getEastMapZoom(e=1){e>10&&(e=10),e<1&&(e=1);selectedZoom=e;if(beforezoom==selectedZoom)return!1;zoomtype=selectedZoom<beforezoom?"zoomout":"zoomin",e=10-e+1;let t=document.getElementById(mapID);for(const o of t.children){if("map-image"==o.className){let n,a,s=o;for(const e of s.attributes)"main-width"==e.name&&(n=e.value),"main-height"==e.name&&(a=e.value);let i=parseInt(n/e),l=parseInt(a/e);s.style.width=i+"px",s.style.height=l+"px",t.style.width=i+"px",t.style.height=l+"px"}if("map-item"==o.className){let t,n,a=o;for(const o of a.children)if("IMG"==o.tagName){let a,s,i=o;for(const e of i.attributes)"main-width"==e.name&&(a=e.value),"main-height"==e.name&&(s=e.value),"main-left"==e.name&&(t=e.value),"main-top"==e.name&&(n=e.value);i.style.width=parseInt(a/e)+"px",i.style.height=parseInt(s/e)+"px"}a.style.left=parseInt(t/e)+"px",a.style.top=parseInt(n/e)+"px"}}}function readTextFile(e,t){var o=new XMLHttpRequest;o.overrideMimeType("application/json"),o.open("GET",e,!0),o.onreadystatechange=function(){4===o.readyState&&"200"==o.status&&t(o.responseText)},o.send(null)}function closeMenu(){let e=document.getElementsByClassName("menu-bar")[0],t=e.classList;t.add("animate__backOutLeft"),t.add("animate__animated"),t.add("animate__faster"),setTimeout((()=>{e.style.display="none"}),525),setTimeout((()=>{t.remove("animate__backOutLeft"),t.remove("animate__animated"),t.remove("animate__faster")}),550)}function openMenu(){let e=document.getElementsByClassName("menu-bar")[0],t=e.classList;t.add("animate__backInLeft"),t.add("animate__animated"),t.add("animate__faster"),e.style.display="block",setTimeout((()=>{}),525),setTimeout((()=>{t.remove("animate__backInLeft"),t.remove("animate__animated"),t.remove("animate__faster")}),550)}function getGETParam(e){var t=null,o=[];return location.search.substr(1).split("&").forEach((function(n){(o=n.split("="))[0]===e&&(t=decodeURIComponent(o[1]))})),t}function speakText(e){var t=new SpeechSynthesisUtterance;t.text=e,window.speechSynthesis.speak(t)}$(document).on("click",".satallite-on-off-btn",(function(){satalliteShow=!satalliteShow,satalliteShow?$("#satelliteMap").css("display","block"):$("#satelliteMap").css("display","none")}));